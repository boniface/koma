TODO: Explain how to write code generic to matrix type and efficient known-type code without boxing